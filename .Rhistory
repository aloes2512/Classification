library(tidyverse)
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"BW_list_tbl.RData"))
summary(BW_list_tbl)
BW_list_tbl %>% head(30)
"NO2" %in% (names(BW_list_tbl$Alb))
comp_detect <- function(df,cmp) {
exst<- cmp %in% names(df)
return(exst)
}
comp_detect(BW_list_tbl$Alb,"NO2")
load(file.path(url_Rdat,"BW.RData"))
summary(BW.all_data)
BW_mean_median_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE),NA))
)
BW_mean_median_NO2
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) (ifelse (comp_detect (x,"NO2"),
var(x$NO2,na.rm=TRUE),NA)))
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
mean(x$WG,na.rm=TRUE),NA )))
BW_var_WG <-map_dbl(BW_list_tbl,function(x) { ifelse(comp_detect (x,"WG"),var(x$WG,na.rm=TRUE),NA) })
BW_mean_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE),
NA))
)
BW_median_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
median(x$NO2,na.rm=TRUE),NA))
)
BW_keydata<- tibble(Mean=BW_mean_NO2,
Median= BW_median_NO2,
Var= BW_var_NO2)
BW_keydata
station_nms<-names(BW_list_tbl)
station_nms
BW_keydata<- tibble(Stations=names(BW_list_tbl),
Mean_NO2=BW_mean_NO2,
Median_NO2= BW_median_NO2,
Var_NO2= BW_var_NO2)
BW_keydata
?kable
??kable
?knittr::kable
?knitr::kable
library(knitr)
kable(BW_keydata)
kable(BW_keydata,round(c(Mean_NO2,Median_NO2,Var_No2)))
kable(BW_keydata,round(c("Mean_NO2","Median_NO2","Var_NO2")))
kable(BW_keydata,format=round(c("Mean_NO2","Median_NO2","Var_NO2")))
kable(BW_keydata,format=round("Mean_NO2","Median_NO2","Var_NO2"))
kable(BW_keydata,format=round("Mean_NO2",round(0)))
kable(BW_keydata,format=round(0))
kable(BW_keydata)
kable(BW_keydata,digits=1)
save(BW_keydata,"~/projects/Classification/rdat/"BW_keydata.RData")
save(BW_keydata,"rdat/BW_keydata.RData")
save(BW_keydata,"/rdat/BW_keydata.RData")
save(BW_keydata,"rdat/BW_keydata.RData")
save(BW_keydata,"BW_keydata.RData")
saveRDS(BW_keydata,"rdat/BW_keydata.RData")
head(BW_list_tbl$Alb,2)
BW_list_tbl$Alb%>% ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.1)
BW_list_tbl$Alb%>% ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.01)
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.01)
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth("lm", aes(x=datetime,y= NO2,col = "red"))
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth("lm",mapping =  aes(x=datetime,y= NO2,col = "red"))
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth("lm",mapping =  aes(x=datetime,y= NO2,col = "red"),data=.)
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth("lm",mapping =  aes(x=datetime,y= NO2,col = "red"),
data=BW_list_tbl$Alb%>% na.omit())
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth(method = "lm",mapping =  aes(x=datetime,y= NO2,col = "red"),
data=BW_list_tbl$Alb%>% na.omit())
BW_list_tbl$Alb%>% na.omit()%>%
ggplot(aes(x = datetime))+
geom_point(aes(y= NO2),size = 0.001)+
geom_smooth(method = "lm",mapping =  aes(x=datetime,y= NO2),
data=BW_list_tbl$Alb%>% na.omit(),col = "red")
BW_mean_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE),NA))
)
library(tidyverse)
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"BW_list_tbl.RData"))
summary(BW_list_tbl)
BW_list_tbl$Man_Mitte<- NULL
"NO2" %in% (names(BW_list_tbl$Alb))
comp_detect <- function(df,cmp) {
exst<- cmp %in% names(df)
return(exst)
}
comp_detect(BW_list_tbl$Alb,"NO2")
#function for plotting
plt_NO2_trnd <- function(df) {
df<-df%>% na.omit()%>% as_tibble()
ifelse (comp_detect(df,"NO2"),
plt <-ggplot(df,aes(x= datetime,y=NO2))+
geom_point(size = 0.001)+
geom_smooth(method= "lm",col = "red")+
ggtitle("NO2-immissions 20 years",
subtitle = paste(first(df$name),first(df$station))),NA
)
ggsave(paste0("NO2_trend_20y_",first(df$name),".png"),path = "figs/")
}
map(BW_list_tbl,plt_NO2_trnd)
BW_mean_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE),NA))
)
BW_median_NO2<- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
median(x$WG,na.rm=TRUE),NA )))BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) (ifelse (comp_detect (x,"NO2"),
var(x$NO2,na.rm=TRUE),NA)))
BW_var_WG <-map_dbl(BW_list_tbl,function(x) (ifelse(comp_detect (x,"WG"),
var(x$WG,na.rm=TRUE),NA) ))
names(BW_list_tbl)
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) (ifelse (comp_detect (x,"NO2"),
var(x$NO2,na.rm=TRUE),NA)))
BW_summary_data <- tibble(Station = names(BW_list_tbl),
NO2_mean = BW_mean_NO2,
NO2_median = BW_median_NO2,
NO2_var = BW_var_NO2,
WG_mean = BW_mean_WG,
WG_var = BW_var_WG)
BW_median_NO2<- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
median(x$WG,na.rm=TRUE),NA )))
BW_summary_data <- tibble(Station = names(BW_list_tbl),
NO2_mean = BW_mean_NO2,
NO2_median = BW_median_NO2,
NO2_var = BW_var_NO2,
WG_mean = BW_mean_WG,
WG_var = BW_var_WG)
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
mean(x$WG,na.rm=TRUE),NA )))
BW_var_WG <-map_dbl(BW_list_tbl,function(x) (ifelse(comp_detect (x,"WG"),
var(x$WG,na.rm=TRUE),NA) ))
BW_summary_data <- tibble(Station = names(BW_list_tbl),
NO2_mean = BW_mean_NO2,
NO2_median = BW_median_NO2,
NO2_var = BW_var_NO2,
WG_mean = BW_mean_WG,
WG_var = BW_var_WG)
BW_summary_data%>% head()
