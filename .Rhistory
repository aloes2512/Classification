library(tidyverse)
library(readxl)
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"ALB_tbl.RData"))
load(file.path(url_Rdat,"BW.RData"))
summary(ALB_tbl)
summary(BW.all_data)
BW.all_data$Alb%>%summary()
ALB_data<- BW.all_data$Alb
ALB_data$Alb.O3%>% head()
library(purrr)
library(tidyverse)
library(lubridate)
mein_file <- list.files(pattern = "_bearbeitet_[0-9]+\\.csv")
mein_file
mein_file <- list.files(path= "~/documents/IMMOBILIEN/GbR/Abrechnung_V+V/2017/",pattern = "_bearbeitet_[0-9]+\\.csv")
mein_file
# die gleiche Funktion mit map
d2 <- map_df(mein_file,read_csv2) %>% tbl_df() %>% as_tibble()
mein_path<-"~/documents/IMMOBILIEN/GbR/Abrechnung_V+V/2017/"
# die gleiche Funktion mit map
d2 <- map_df(mein_file,function(x)read_csv2(file.path(mein_path,x))) %>% tbl_df() %>% as_tibble()
# die gleiche Funktion mit map
d2 <- map_df(mein_file,function(x)read_delim(file.path(mein_path,x))) %>% tbl_df() %>% as_tibble()
# die gleiche Funktion mit map
d2 <- map(mein_file,function(x)read_delim(file.path(mein_path,x))) %>% tbl_df() %>% as_tibble()
library(purrr)
library(repurrrsive)
url<- "https://jennybc.github.io/purrr-tutorial/"
browseURL(url)
class(got_chars)
summary(got_chars[[1]])
str(wesanderson)
str(got_chars)
str(got_chars,list.len=3)
summary(got_chars[[1]])
got_chars[1]%>%map(~.$gender)
got_chars%>%map(~.$gender)
summary(got_chars)
names(got_chars)
names(got_chars[[1]])
got_chars%>%map(~.$gender)
names(got_chars)<-map_chr(got_chars,~.$name)
names(got_chars)
got_chars[[1]]$url
map(got_chars,"name")
map_chr(got_chars,~.$name)
got_chars[23:25]%>%map_chr(.,"url")
#>
#> Attaching package: 'magrittr'
#> The following object is masked from 'package:purrr':
#>
#>     set_names
x <- map(got_chars, magrittr::extract, c("name", "culture", "gender", "born"))
str(x[18:19])
BW_list
BW.all_data$Alb%>%summary()
summary(BW.all_data)
ALB_data%>% map(.,magrittr::extract,c("Alb.O3"))
ALB_data%>% map(.,magrittr::extract,c("Alb"))
ALB_data$Alb.O3%>% head()
ALB_data%>% map(.,magrittr::extract,c("datetime","O3"))
ALB_data%>% map(.,magrittr::extract,c("datetime",O3))
ALB_data%>% map(.,magrittr::extract,c("datetime"))
ALB_data%>% map_df(.,magrittr::extract,c("datetime"))
ALB_data%>% map_df(.,magrittr::extract,c("datetime","NO2"))
ALB_data%>% map_df(.,c("datetime","NO2"))
ALB_data%>% map_df(.,c("datetime","Alb.NO2"))
ALB_data$Alb.O3%>% head()
BW.all_data$Alb
names(BW.all_data$Alb)
names(BW.all_data$Alb)%>%str_replace("Alb.","")
names(BW.all_data$Alb)<-names(BW.all_data$Alb)%>%str_replace("Alb.","")
ALB_data%>% map_df(.,c("datetime","NO2"))
ALB_data%>% map_df(.,magrittr::extract, c("datetime","NO2"))
BW.all_data$Alb
ALB_data%>% map2(.,names(Alb_data),magrittr::extract, c("datetime","NO2"))
ALB_data<- BW.all_data$Alb
names(BW.all_data$Alb)<-names(BW.all_data$Alb)%>%str_replace("Alb.","")
ALB_data$O3%>% head()
ALB_data%>% map2(.,names(Alb_data),magrittr::extract, c("datetime","NO2"))
ALB_data%>% map2(.,names(.), c("datetime","NO2"))
nm_comp<- names(BW.all_data$Alb)
nm_comp
ALB_data$O3%>% head()
ALB_data %>% map(.$O3)
ALB_data %>% map(~.$O3)
map2(ALB_data,nm_comp,~x$y)
map2(ALB_data,nm_comp,~.x$.y)
map2(x=ALB_data,y=nm_comp,~.x$.y)
map2(x=ALB_data,y=nm_comp,~x$y)
map2(x=ALB_data,y=nm_comp,function(x,y)x$y)
map2(x=ALB_data,y=nm_comp,~function(x,y)x$y)
map2(x=ALB_data,y=nm_comp,~x[[y]])
map2(x=ALB_data,y=nm_comp,~x[y])
ALB_data %>% map(.,`[`,nm_comp)
ALB_data
ALB_data %>% map(.,nm_comp)
ALB_data %>% map(~.$,nm_comp)
ALB_data %>% map(~.$nm_comp)
load("/Users/alfloeffler/Documents/Luftqualitaet/Daten/BW_Rdat/BW_list_tbl.RData")
View(BW_list_tbl)
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"BW_list_tbl.RData"))
summary(BW_list_tbl)
BW_list
BW_list_tbl
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)  })
BW_mean_median_NO2
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) {var(x$NO2,na.rm=TRUE)})
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) {mean(x$WG,na.rm=TRUE) })
BW_list_tbl %>% head()
BW_var_WG <-map_dbl(BW_list_tbl,function(x) { ifelse(sum(!is.na(x$WG))>0,var(x$WG,na.rm=TRUE),NA) })
BW_mean_WG<-BW_mean_WG[!is.na(BW_mean_WG)]
names(BW_mean_WG)
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"BW_list_tbl.RData"))
summary(BW_list_tbl)
load(file.path(url_Rdat,"BW.RData"))
summary(BW.all_data)
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)  })
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) {var(x$NO2,na.rm=TRUE)})
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) {mean(x$WG,na.rm=TRUE) })
warnings()
q()
url_Rdat<- "~/Documents/Luftqualitaet/Daten/BW_Rdat/"
list.files(path=url_Rdat)
load(file.path(url_Rdat,"BW_list_tbl.RData"))
summary(BW_list_tbl)
load(file.path(url_Rdat,"BW.RData"))
summary(BW.all_data)
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)  })
library(tidyverse)
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)  })
BW_mean_median_NO2
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) {var(x$NO2,na.rm=TRUE)})
BW_var_NO2
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) {mean(x$WG,na.rm=TRUE) })
BW_list_tbl %>% head()
BW_list_tbl %>% head(30)
BW_list_tbl$Alb%>% exists("NO2")
BW_list_tbl$Alb%>% exists(names(.))
names(BW_list_tbl$Alb)
names(BW_list_tbl$Alb)%>%exists("NO2")
names(BW_list_tbl$Alb)%>%"NO2" %in% (.)
"NO2" %in% (names(BW_list_tbl$Alb))
comp_detect <- function(df,cmp) {
exst<- cmp %in% names(df)
}
comp_detect(BW_list_tbl$Alb,comp= "NO2")
comp_detect(BW_list_tbl$Alb,"NO2")
return(exst)
comp_detect <- function(df,cmp) {
exst<- cmp %in% names(df)
return(exst)
}
comp_detect(BW_list_tbl$Alb,"NO2")
comp_detect <- function(df,cmp) {
exst<- cmp %in% names(df)
return(exst)
}
x <- BW_list_tbl$Alb
if comp_detect (x,"NO2")
( mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)) else NA
ifelse comp_detect (x,"NO2")
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE),NA
comp_detect (x,"NO2")
ifelse comp_detect (x,"NO2")
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)),NA
ifelse comp_detect (x,"NO2")
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE))
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {ifelse comp_detect (x,"NO2")
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE))
}
)
BW_mean_median_NO2<-map_dbl{BW_list_tbl, function(x) ( ifelse comp_detect (x,"NO2")
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)))
}
ifelse comp_detect (x,"NO2")
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE))
ifelse (comp_detect (x,"NO2"))
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE))
BW_mean_median_NO2<-map_dbl(BW_list_tbl,function(x) {mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)  })
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) {var(x$NO2,na.rm=TRUE)})
BW_mean_median_NO2<-map_dbl{BW_list_tbl , function(x,"NO2") ( ifelse (comp_detect (x,"NO2"))
(mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)))
}
comp_detect(BW_list_tbl$Alb,"NO2")
comp_detect(x,"NO2")
ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE)),NA)
ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE),NA)
BW_mean_median_NO2<-map_dbl{BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE),NA))
}
BW_mean_median_NO2<-map_dbl(BW_list_tbl , function(x) ( ifelse (comp_detect(x,"NO2"),
mean(x$NO2,na.rm=TRUE)-
median(x$NO2,na.rm=TRUE),NA))
)
BW_mean_median_NO2
ifelse (comp_detect (x,"NO2"),
var(x$NO2,na.rm=TRUE),NA)
BW_var_NO2 <- map_dbl(BW_list_tbl, function(x) (ifelse (comp_detect (x,"NO2"),
var(x$NO2,na.rm=TRUE),NA)))
BW_var_NO2
BW_mean_WG <- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
mean(x$WG,na.rm=TRUE),NA )))
BW_mean_WG
BW_var_WG <-map_dbl(BW_list_tbl,function(x) { ifelse(sum(!is.na(x$WG))>0,var(x$WG,na.rm=TRUE),NA) })
BW_var_WG <-map_dbl(BW_list_tbl,function(x) { ifelse(comp_detect (x,"WG"),var(x$WG,na.rm=TRUE),NA) })
BW_var_WG
BW_median_NO2<- map_dbl(BW_list_tbl,function(x) (ifelse (comp_detect (x,"WG"),
median(x$WG,na.rm=TRUE),NA )))
